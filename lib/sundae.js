// Generated by CoffeeScript 1.6.3
(function() {
  var Sundae, express, http, socketIo, sundae, _;

  _ = require('lodash');

  http = require('http');

  express = require('express');

  socketIo = require('socket.io');

  Sundae = (function() {
    function Sundae() {
      this.attrs = {};
    }

    Sundae.prototype.init = function(options) {
      var app, io, server;
      if (options == null) {
        options = {};
      }
      this.options = _.extend({
        port: 3011
      }, options);
      app = this.app = express();
      server = this.server = http.createServer(app);
      io = this.io = socketIo.listen(server);
      return this;
    };

    Sundae.prototype.set = function(key, val) {
      this.attrs[key] = val;
      return this;
    };

    Sundae.prototype.get = function(key) {
      return this.attrs[key];
    };

    Sundae.prototype.run = function(callback) {
      if (callback == null) {
        callback = function() {};
      }
      this.server.listen(this.options.port, callback);
      return this;
    };

    Sundae.prototype.use = function(widget) {
      if (typeof widget === 'function') {
        widget.call(this);
      }
      return this;
    };

    return Sundae;

  })();

  sundae = new Sundae;

  sundae.Sundae = Sundae;

  sundae.router = require('./widgets/router')(sundae);

  sundae.config = require('./widgets/config')(sundae);

  sundae.error = require('./widgets/error');

  module.exports = sundae;

}).call(this);
